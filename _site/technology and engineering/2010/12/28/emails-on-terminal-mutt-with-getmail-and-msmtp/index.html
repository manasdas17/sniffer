<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="None worth writing.">
    <title>Emails with terminal - Mutt with getmail and msmtp</title>
    <meta name="author" content="Dilawar Singh" />
    <link rel="stylesheet" href="https://github.com/themes/minimal/stylesheets/styles.css">
 <style>
      header { zoom: 1.0; width: 150px}
      header h1 { margin-bottom: 5px; }
      header h1 a { color: #494949; font-weight: bold; }
      header h3 { margin-top: 20px; margin-bottom: 5px; }
      header p.view { margin-bottom: 5px; }
      header p.view small { padding-top: 2px; }
      header ul {
        zoom: 0.7;
        margin-top: 25px;
      }
      section { width: 600px }
      section p { margin-top: 10px; }
      section h1 { margin-bottom: 15px; }
      section h2 { margin-bottom: 10px; }
      section h2 { margin-bottom: 10px; }
      footer { bottom: 20px; }
      footer p { margin-bottom: 5px; }
      .half-width {
        float: left;
        width: 100px;
        list-style: none;
        padding: 5px;
        margin: 7px;
        margin-bottom: 10px;
      }
      .half-width h4 {
        margin-bottom: 5px;
      }
      .half-width ul {
        padding-left: 0;
      }
      .half-width ul li {
        list-style: inside;
        font-size: 15px;
      }
      .clear-fix {
        clear: both;
      }
    </style>
    <script src="https://github.com/themes/minimal/javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
</head>

<body>
    <div class="wrapper">
        <header>
        <h1><a href="/">Notes</a></h1>
        <p class="view"> <img src= "http://dilawar.github.io/images/pic_enhanced.jpg"
            alt="dilawar" height="150" width="150" /> </p>
        <p class="view"><a href="/projects/index.html">Open Source Projects <small>Might be useful to you</small></a></p>
        <p class="view"><a target="_blank"
            href="http://www.cen.iitb.ac.in/">Masters<small>Microelectronics and
                VLSI</small></a> 
        </p>
        <p class="view"><a target="_blank"
            href="http://www.ee.iitb.ac.in/~hpc">Ph. D.</a><small>Abandoned
            after 3 years</small>
        </p>
        <p class="view"><a target="_blank"
            href="http://www.ncbs.res.in/bhalla">Research Fellow <small>Moose,
                The Neural Simulator</small> </a> 
        </p>
        <p class="view"><a target="_blank"
            href="http://dilawarrajput.wordpress.com">Blog <small>This much I
                know</small></a> 
        </p>

        
        </header>

        <footer>
        </footer>

    <section id="post">
    <h1>Emails with terminal - Mutt with getmail and msmtp </h1>
<div class="content">
  <p>Hello, terminal lovers. There are many other blogs written about 'mutt' and 'getmail'. Surely you can take hints from any of them. This post is written for IIT Bombay email servers. You pathetic Windows guys, piss off!!</p>

<h3>Get Emails from Server</h3>

<p>First of all, we need to use 'something' to fetch emails from gpo server. Mutt can be used to read directly from server. But I like storing my emails on my machine. I prefer <a href="http://en.wikipedia.org/wiki/Getmail">'getmai</a>l' over fetchmail to do that for reasons I don't know. It is an awesome tool to do that since it never gave me trouble. IIT Bombay email server supports IMAP. We have to configure getmail to fetch mails from there using IMAP and store it somewhere.</p>

<p>Here is the script of this. Make sure you have three directories in /GPO-IITB/ directory named 'cur', 'new', and 'temp' (without single quote). We are storing emails in two type of mainboxes, maildir and mboxrd. To understand these concepts read <a href="http://pyropus.ca/software/getmail/configuration.html">this</a>. Name this file 'getmail.gpo' and store it in ~/.getmail directory.</p>

<p>[sourcecode language="txt"]</p>

<p>[retriever]
type = SimpleIMAPRetriever
server = imap.iitb.ac.in
username = khookhar
password = darinda</p>

<p>[destination]
type = MultiDestination
destinations = ('[mboxrd-destination]', '[maildir-destination]')</p>

<p>[mboxrd-destination]
type = Mboxrd
path = ~/Mail/GPO-IITB/gpo_backup.mbox</p>

<p>[maildir-destination]
type = Maildir
path = ~/Mail/GPO-IITB/</p>

<p>[options]
verbose = 2
read_all = False
message_log = ~/.getmail/gpo.log</p>

<p>[/sourcecode]</p>

<p>If you also wants EE account then create one more file getmail.ee as following.</p>

<p>[sourcecode language="text"]</p>

<p>[retriever]
type = SimpleIMAPRetriever
server = sandesh.ee.iitb.ac.in
username = profchaos
password = ihatekartman</p>

<p>[destination]
type = MultiDestination
destinations = ('[mboxrd-destination]', '[maildir-destination]')</p>

<p>[mboxrd-destination]
type = Mboxrd
path = ~/Mail/EE-IITB/ee_backup.mbox</p>

<p>[maildir-destination]
type = Maildir
path = ~/Mail/EE-IITB/</p>

<p>[options]
verbose = 2
read_all = False
message_log = ~/.getmail/ee.log
[/sourcecode]</p>

<p>Now run from terminal.
<code>
$getmail -r getmail.gpo
$getmail -r getmail.ee
</code>
First line will download all new messages into local directories. Now you are ready to read them using mutt or some other client. This will not delete messages from your server.</p>

<h3>Using mutt to read and send emails</h3>

<p>Here is my <p>~/.muttrc</p> file for this purpose. Not that even if you are storing a same message in two mailbox we are only using one mailbox to read and send message. Other one is for backup.</p>

<p>[sourcecode]</p>

<h1>Name</h1>

<p>set realname = 'Prof Chaos'</p>

<h6>#</h6>

<h1>This is to read gmail message directly from server.</h1>

<p>set folder = "imaps://imap.gmail.com:993"
set spoolfile = "+INBOX"
set postponed = "+[Gmail]/Drafts"
set trash = "imaps://imap.gmail.com/[Gmail]/Trash"
set username = "profchaos@gmail.com"
set password = "ihatekartman"</p>

<h2>set local folder.</h2>

<p>set header_cache = ~/.mutt/cache/headers
set message_cachedir = ~/.mutt/cache/bodies
set certificate_file = ~.mutt/certificates</p>

<p>#</p>

<h2>where mails are stored</h2>

<p>set folder = ~/Mail/
mailboxes = GPO-IITB
mailboxes = EE-IITB
mailboxes = INBOX
set record = ~/Mail/GPO-IITB/sent
set sort = threads
set postponed = ~/Mail/GPO-IITB/drafts
set mbox_type = MailDir
set content_type = "text/html"
set signature = "~/Mail/sign.html"</p>

<h1>message-hook ~A 'set pager=vim'</h1>

<h2>message-hook '~f rfs' 'set pager="less"+/^ subject: .*\""'</h2>

<h2>this our send email client.</h2>

<p>set sendmail = "/usr/bin/msmtp"</p>

<h2>Editor</h2>

<p>set editor = "vim"
ignore *
unignore date from subject to cc
#</p>

<h3>mutt option</h3>

<h2>#</h2>

<p>set folder_format = "%2C %t %N %8s %d %f"
set edit_headers = no
set askbcc = yes
set text_flowed = yes</p>

<p>set abort_nosubject = ask-yes
set abort_unmodified = ask-yes
set copy = yes
set include = yes
set metoo  = yes # send reply to myself.</p>

<p>set hdrs
my_hdr From: Dilawar
my_hdr X-Mailer: 'mutt -v| head -n 1'
macro generic "1" ":set from 'Dilawar '"</p>

<p>color   hdrdefault      brightcyan      black
color   header          brightwhite     black "<sup>from:"</sup>
color   header          brightwhite     black   "<sup>subject:"</sup>
color   quoted          brightgreen     blue
color   quoted          brightwhite     blue
color   quoted          brightwhite     blue
color   signature       brightwhite     black</p>

<p>color   indicator       blue            green</p>

<p>color   error           red             black
mono    error           bold
color   status          black cyan
mono    status          bold
color   tree            yellow          blue</p>

<p>color   tilde           brightmagenta   blue
color   body            red             black    "[-a-z_0-9.]+@[-a-z_0-9.]+"
mono    body            bold                    "[-a-z_0-9.]+@[-a-z_0-9.]+"
color   body            red             black   "<sup>Good</sup> signature"
mono    body            bold                    "<sup>Good</sup> signature"
color   body            brightwhite     red     "<sup>Bad</sup> signature from.<em>"
mono    body            bold                    "<sup>Bad</sup> signature from.</em>"
color   normal          white            black
color   message         red            white
color   attachment      red            blue</p>

<h2>Here is address-book</h2>

<p>alias epw-circulation Circulation
alias harami harami
alias pilla pilla
[/sourcecode]</p>

<p>Now we need to send email. We have choses 'msmtp' as our send-mail client. Configure it too. We are using iitb-gpo
for sending emails.</p>

<p>[sourcecode]
account default
host smtp-auth.iitb.ac.in
port 25
protocol smtp
auth on
from profchaos@iitb.ac.in
user profchaos
password ihatecartman
tls on
tls_starttls on
tls_certcheck off
[/sourcecode]</p>

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li> <a href="/numerical%20computation/2014/01/30/Coding-With-Floats/">Coding with float</a></li>
    
      <li> <a href="/noguinomousenoproblem/2014/01/29/Using-mutt/">Using mutt, saving password and writing mail in markdown</a></li>
    
      <li> <a href="/[%22tutorial%22,%20%22literate%20programming%22]/2013/10/30/Python-frontend-for-noweb/">Python front-end for Noweb literate tool</a></li>
    
  </ul>
</div>

<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

<!-- Google analytic -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47774588-1', 'dilawar.github.io');
    ga('send', 'pageview');
</script>

<div id="comment">
  
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'dilawarblog'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>



    </section>

    <!-- Latex in post -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Google analytic -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-47774588-1', 'dilawar.github.io');
        ga('send', 'pageview');
    </script>
</body>
</html>
