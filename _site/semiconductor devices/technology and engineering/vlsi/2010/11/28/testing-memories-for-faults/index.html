<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="None worth writing.">
    <title>Testing memories for faults</title>
    <meta name="author" content="Dilawar Singh" />
    <link rel="stylesheet" href="https://github.com/themes/minimal/stylesheets/styles.css">
 <style>
      header { zoom: 1.0; width: 150px}
      header h1 { margin-bottom: 5px; }
      header h1 a { color: #494949; font-weight: bold; }
      header h3 { margin-top: 20px; margin-bottom: 5px; }
      header p.view { margin-bottom: 5px; }
      header p.view small { padding-top: 2px; }
      header ul {
        zoom: 0.7;
        margin-top: 25px;
      }
      section { width: 600px }
      section p { margin-top: 10px; }
      section h1 { margin-bottom: 15px; }
      section h2 { margin-bottom: 10px; }
      section h2 { margin-bottom: 10px; }
      footer { bottom: 20px; }
      footer p { margin-bottom: 5px; }
      .half-width {
        float: left;
        width: 100px;
        list-style: none;
        padding: 5px;
        margin: 7px;
        margin-bottom: 10px;
      }
      .half-width h4 {
        margin-bottom: 5px;
      }
      .half-width ul {
        padding-left: 0;
      }
      .half-width ul li {
        list-style: inside;
        font-size: 15px;
      }
      .clear-fix {
        clear: both;
      }
    </style>
    <script src="https://github.com/themes/minimal/javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
</head>

<body>
    <div class="wrapper">
        <header>
        <h1><a href="/">Notes</a></h1>
        <p class="view"> <img src= "http://dilawar.github.io/images/pic_enhanced.jpg"
            alt="dilawar" height="150" width="150" /> </p>
        <p class="view"><a href="/projects/index.html">Open Source Projects <small>Might be useful to you</small></a></p>
        <p class="view"><a target="_blank"
            href="http://www.cen.iitb.ac.in/">Masters<small>Microelectronics and
                VLSI</small></a> 
        </p>
        <p class="view"><a target="_blank"
            href="http://www.ee.iitb.ac.in/~hpc">Ph. D.</a><small>Abandoned
            after 3 years</small>
        </p>
        <p class="view"><a target="_blank"
            href="http://www.ncbs.res.in/bhalla">Research Fellow <small>Moose,
                The Neural Simulator</small> </a> 
        </p>
        <p class="view"><a target="_blank"
            href="http://dilawarrajput.wordpress.com">Blog <small>This much I
                know</small></a> 
        </p>

        
        </header>

        <footer>
        </footer>

    <section id="post">
    <h1>Testing memories for faults </h1>
<div class="content">
  <p>As the VLSI memories are shrinking in their size, the density of cells which
holds data is increasing exponentially. If one is making a living out of
manufacturing them then he must make sure product he is releasing in the market
is fault free. So he must hire some trained person to test memories of how much
they are faulty. <strong>I wish I could do that with my natural memory </strong>. So at least
he can make an informed decision whether he should sell his faulty product. In
memories many kind of faults can occur. Most prominent of those are <strong>stuck-at
faults </strong> (when some bit is permanently stuck to 0 or 1 value); <strong>coupling
faults </strong> (write in in one location of memory can change the values at some
other location), and <strong>Pattern Sensitive Faults </strong> (a certain pattern in some
locations of memory will not allow to write at some address.) Another kind of
faults are <strong>Decoder faults</strong> in which decoder itself have some faults (thus
more than one addresses are mapped onto one address and any write will write at
multiple locations). Not all of these faults can be test by a single test.
Testing for all the faults are time consuming because they are so many of them.
However if certain combination of tests, will limited yet sufficient coverage,
does not detect faults in memory then one can be pretty sure that this memory
does not contain many faults which are undetected.</p>

<p>Here in this post, We give some primitive tests  to detect these faults. Lets
say following is my memory block.</p>

<div class="highlight"><pre><code class="vhdl"><span class="k">entity</span> <span class="nc">MemBlock</span> <span class="k">is</span> 
    <span class="k">generic</span><span class="p">(</span><span class="n">has_decoder_fault</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span><span class="p">,</span> <span class="n">has_psf</span><span class="p">,</span> <span class="n">has_cf</span><span class="o">:</span> <span class="kt">boolean</span> <span class="o">:=</span> <span class="n">false</span><span class="p">);</span>
    <span class="k">port</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
            <span class="n">read_en</span><span class="p">,</span> <span class="n">write_en</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit</span><span class="p">;</span>
            <span class="n">data_out</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">));</span>
<span class="k">end</span> <span class="k">entity</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">Behave</span> <span class="k">of</span> <span class="nc">MemBlock</span> <span class="k">is</span>
    <span class="k">type</span> <span class="n">MemArray</span> <span class="k">is</span> <span class="k">array</span> <span class="p">(</span><span class="kt">natural</span> <span class="k">range</span> <span class="o">&lt;&gt;</span><span class="p">)</span> <span class="k">of</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="c1">-- procedure that models the update of the memory array,</span>
    <span class="c1">-- given an incoming word (data_in) and a row index (I)</span>
    <span class="k">procedure</span> <span class="n">Update_Mem</span><span class="p">(</span><span class="k">signal</span> <span class="n">mem_array</span><span class="o">:</span> <span class="k">inout</span> <span class="n">MemArray</span><span class="p">;</span><span class="n">I</span><span class="o">:</span> <span class="k">in</span> <span class="kt">integer</span><span class="p">;</span> <span class="n">data_in</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">))</span> <span class="k">is</span>
        <span class="k">variable</span> <span class="n">cword</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">variable</span> <span class="n">uI</span><span class="p">,</span> <span class="n">dI</span><span class="o">:</span> <span class="kt">integer</span><span class="p">;</span>
        <span class="k">variable</span> <span class="n">aflag</span> <span class="o">:</span> <span class="kt">boolean</span><span class="p">;</span> <span class="c1">-- set true when write is over.</span>
    <span class="k">begin</span>

        <span class="n">aflag</span> <span class="o">:=</span> <span class="n">false</span><span class="p">;</span>

        <span class="c1">-- PSF</span>
        <span class="k">if</span><span class="p">(</span><span class="n">I</span> <span class="o">=</span> <span class="mi">128</span> <span class="k">and</span> <span class="n">has_psf</span><span class="p">)</span> <span class="k">then</span> 
            <span class="n">uI</span> <span class="o">:=</span> <span class="mi">129</span><span class="p">;</span>
            <span class="n">dI</span> <span class="o">:=</span> <span class="mi">127</span><span class="p">;</span> 
            <span class="n">cword</span> <span class="o">:=</span> <span class="n">mem_array</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
            <span class="k">for</span> <span class="n">J</span> <span class="k">in</span> <span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span> <span class="k">loop</span>
                <span class="c1">-- here is the PSF</span>
                <span class="k">if</span> <span class="k">not</span> <span class="p">(</span> <span class="n">mem_array</span><span class="p">(</span><span class="n">uI</span><span class="p">)(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span> <span class="k">and</span> <span class="n">mem_array</span><span class="p">(</span><span class="n">dI</span><span class="p">)(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span><span class="p">)</span> <span class="k">then</span>
                    <span class="n">mem_array</span><span class="p">(</span><span class="n">I</span><span class="p">)(</span><span class="n">J</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">data_in</span><span class="p">(</span><span class="n">J</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span> 
            <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
            <span class="n">aflag</span> <span class="o">:=</span> <span class="n">true</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">127</span> <span class="k">and</span> <span class="n">has_cf</span><span class="p">)</span> <span class="k">then</span>
            <span class="k">if</span><span class="p">(</span><span class="n">mem_array</span><span class="p">(</span><span class="mi">127</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span> <span class="k">and</span> <span class="n">data_in</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span><span class="p">)</span> <span class="k">then</span>
                <span class="n">mem_array</span><span class="p">(</span><span class="mi">128</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
            <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
            <span class="n">mem_array</span><span class="p">(</span><span class="mi">127</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">data_in</span><span class="p">;</span>
            <span class="n">aflag</span> <span class="o">:=</span> <span class="n">true</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">129</span> <span class="k">and</span> <span class="n">has_cf</span><span class="p">)</span> <span class="k">then</span>
            <span class="k">if</span><span class="p">(</span><span class="n">mem_array</span><span class="p">(</span><span class="mi">129</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span> <span class="k">and</span> <span class="n">data_in</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span><span class="p">)</span> <span class="k">then</span>
                <span class="n">mem_array</span><span class="p">(</span><span class="mi">128</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
            <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
            <span class="n">mem_array</span><span class="p">(</span><span class="mi">129</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">data_in</span><span class="p">;</span>
            <span class="n">aflag</span> <span class="o">:=</span> <span class="n">true</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="k">not</span> <span class="n">aflag</span><span class="p">)</span> <span class="k">then</span>
            <span class="n">mem_array</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">data_in</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="n">has_stuck_at_fault</span><span class="p">)</span> <span class="k">then</span>
            <span class="n">mem_array</span><span class="p">(</span><span class="mi">129</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
            <span class="n">mem_array</span><span class="p">(</span><span class="mi">128</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

    <span class="k">end</span> <span class="k">procedure</span><span class="p">;</span>
    

  <span class="c1">-- converts bit vector to a natural number</span>
  <span class="k">function</span> <span class="n">To_Natural</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">)</span> <span class="k">return</span> <span class="kt">natural</span> <span class="k">is</span>
    <span class="k">variable</span> <span class="n">ret_var</span> <span class="o">:</span> <span class="kt">natural</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">alias</span> <span class="n">lx</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="n">x</span><span class="na">&#39;length</span> <span class="k">downto</span> <span class="mi">1</span><span class="p">)</span> <span class="k">is</span> <span class="n">x</span><span class="p">;</span>
  <span class="k">begin</span>
    <span class="k">for</span> <span class="n">I</span> <span class="k">in</span> <span class="mi">1</span> <span class="k">to</span> <span class="n">lx</span><span class="na">&#39;length</span> <span class="k">loop</span>
        <span class="k">if</span><span class="p">(</span><span class="n">lx</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span><span class="p">)</span> <span class="k">then</span>
            <span class="n">ret_var</span> <span class="o">:=</span> <span class="n">ret_var</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ret_var</span><span class="p">);</span>    
  <span class="k">end</span> <span class="nc">To_Natural</span><span class="p">;</span>

  <span class="c1">-- output of the decoder</span>
  <span class="k">signal</span> <span class="n">decode_sig</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">255</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">-- memory array</span>
  <span class="k">signal</span> <span class="n">mem_array</span><span class="o">:</span> <span class="n">MemArray</span><span class="p">(</span><span class="mi">0</span> <span class="k">to</span> <span class="mi">255</span><span class="p">);</span>

<span class="k">begin</span>
  
   <span class="c1">-- decoder process</span>
   <span class="k">process</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
   <span class="k">begin</span>
    <span class="n">decode_sig</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">I</span> <span class="k">in</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">255</span> <span class="k">loop</span>
        <span class="k">if</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="n">To_Natural</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span> <span class="k">then</span>
            <span class="n">decode_sig</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">128</span> <span class="k">and</span> <span class="n">has_decoder_fault</span><span class="p">)</span> <span class="k">then</span>
                <span class="n">decode_sig</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
            <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>

   <span class="k">end</span> <span class="k">process</span><span class="p">;</span>

   <span class="c1">-- memory array access process</span>
   <span class="k">process</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">write_en</span><span class="p">)</span>
    <span class="k">variable</span> <span class="n">data_out_var</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>    
   <span class="k">begin</span>
    <span class="n">data_out_var</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">I</span> <span class="k">in</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">255</span> <span class="k">loop</span>
        <span class="k">if</span> <span class="n">decode_sig</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span> <span class="k">then</span>
        <span class="k">if</span><span class="p">(</span><span class="n">read_en</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span><span class="p">)</span> <span class="k">then</span>
            <span class="n">data_out_var</span> <span class="o">:=</span> <span class="n">data_out_var</span> <span class="k">or</span> <span class="n">mem_array</span><span class="p">(</span><span class="n">I</span><span class="p">);</span> <span class="c1">-- Wired OR</span>
        <span class="k">elsif</span> <span class="n">write_en</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span> <span class="k">then</span>
            <span class="n">Update_Mem</span><span class="p">(</span><span class="n">mem_array</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">data_in</span><span class="p">);</span>
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>    
        <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
    <span class="n">data_out</span> <span class="o">&lt;=</span> <span class="n">data_out_var</span><span class="p">;</span>
   <span class="k">end</span> <span class="k">process</span><span class="p">;</span>

<span class="k">end</span> <span class="nc">Behave</span><span class="p">;</span>
</code></pre></div>


<p>Now here is another file which instantiate these memory blocks with faults in it.</p>

<div class="highlight"><pre><code class="vhdl"><span class="k">entity</span> <span class="nc">MemTest</span> <span class="k">is</span>
<span class="k">end</span> <span class="k">entity</span> <span class="nc">MemTest</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">Behave</span> <span class="k">of</span> <span class="nc">MemTest</span> <span class="k">is</span>

    <span class="c1">-- utility function: to increment an address</span>
    <span class="k">function</span> <span class="n">Increment</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">)</span> <span class="k">return</span> <span class="kt">bit_vector</span> <span class="k">is</span>
        <span class="k">alias</span> <span class="n">lx</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">to</span> <span class="n">x</span><span class="na">&#39;length</span><span class="p">)</span> <span class="k">is</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">variable</span> <span class="n">ret_var</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">to</span> <span class="n">x</span><span class="na">&#39;length</span><span class="p">);</span>
        <span class="k">variable</span> <span class="n">carry</span><span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>
    <span class="k">begin</span>
        <span class="n">carry</span> <span class="o">:=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">I</span> <span class="k">in</span> <span class="n">x</span><span class="na">&#39;length</span> <span class="k">downto</span> <span class="mi">1</span> <span class="k">loop</span>
            <span class="n">ret_var</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">:=</span> <span class="n">lx</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="k">xor</span> <span class="n">carry</span><span class="p">;</span>
            <span class="n">carry</span> <span class="o">:=</span> <span class="n">carry</span> <span class="k">and</span> <span class="n">lx</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
        <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ret_var</span><span class="p">);</span>
    <span class="k">end</span> <span class="nc">Increment</span><span class="p">;</span>

    <span class="k">signal</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">data_out_df</span><span class="p">,</span> <span class="n">data_out_saf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">,</span><span class="n">data_out_cf</span> <span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span> 
    <span class="k">signal</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">write_en</span><span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>

    <span class="c1">-- memory block</span>
    <span class="c1">-- array of 8 bit words, with 8 bit address.</span>
    <span class="c1">-- with the following behaviour.</span>
    <span class="c1">-- </span>
    <span class="c1">-- if read_en = &#39;1&#39; then</span>
    <span class="c1">--      data_out = memory_contents(addr);</span>
    <span class="c1">-- elsif write_en = &#39;1&#39; then</span>
    <span class="c1">--      memory_contents(addr) = data_in;</span>
        <span class="c1">-- </span>
    <span class="k">component</span> <span class="nc">MemBlock</span> 
        <span class="k">generic</span><span class="p">(</span><span class="n">has_decoder_fault</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span><span class="p">,</span> <span class="n">has_psf</span><span class="p">,</span> <span class="n">has_cf</span><span class="o">:</span> <span class="kt">boolean</span> <span class="o">:=</span> <span class="n">false</span><span class="p">);</span>
        <span class="k">port</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
                <span class="n">read_en</span><span class="p">,</span> <span class="n">write_en</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit</span><span class="p">;</span>
                <span class="n">data_out</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">));</span>
    <span class="k">end</span> <span class="k">component</span><span class="p">;</span>

    <span class="k">constant</span> <span class="n">zero8</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>


    
    <span class="c1">-- utility procedures</span>

    <span class="c1">-- Write addr/data pair into memory using write_en</span>
    <span class="k">procedure</span> <span class="n">Write</span><span class="p">(</span><span class="k">signal</span> <span class="n">addr</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">signal</span> <span class="n">data</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">signal</span> <span class="n">write_en</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">;</span>
            <span class="n">addr_var</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
            <span class="n">data_var</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">))</span> <span class="k">is</span>
    <span class="k">begin</span>
            <span class="n">addr</span> <span class="o">&lt;=</span> <span class="n">addr_var</span><span class="p">;</span>
            <span class="n">data</span> <span class="o">&lt;=</span> <span class="n">data_var</span><span class="p">;</span>
            
            <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>  
            <span class="n">write_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>

            <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
            <span class="n">write_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>

            <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
    <span class="k">end</span> <span class="k">procedure</span><span class="p">;</span>

    <span class="c1">-- Read data from memory using read_en, addr.</span>
    <span class="c1">-- NOTE: data must be present on data_out signal on</span>
    <span class="c1">--       completion of procedure.</span>
    <span class="k">procedure</span> <span class="n">Read</span><span class="p">(</span><span class="k">signal</span> <span class="n">addr</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">signal</span> <span class="n">read_en</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">;</span>
        <span class="n">addr_var</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">))</span> <span class="k">is</span>
    <span class="k">begin</span>
        <span class="n">addr</span> <span class="o">&lt;=</span> <span class="n">addr_var</span><span class="p">;</span>
        <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
        <span class="n">read_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
        <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
        <span class="n">read_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
    <span class="k">end</span> <span class="k">procedure</span><span class="p">;</span>
            
                
<span class="k">begin</span>


    <span class="c1">-- four memory blocks, each of which has one type of fault in it.</span>


    <span class="c1">-- this has a decoder-fault</span>
    <span class="n">mb_df</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> 
                    <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_df</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

    <span class="c1">-- this has stuck-at-faults in the array</span>
    <span class="n">mb_saf</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">,</span> 
                    <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_saf</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

    <span class="c1">-- this has a pattern-sensitive-fault in the array.  The neighbourhood for the</span>
    <span class="c1">-- fault is adjacent bits in the same column of the array.</span>
    <span class="n">mb_psf</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> 
                    <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_psf</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

    <span class="c1">-- this has some coupling faults in the array</span>
    <span class="n">mb_cf</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> 
                    <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_cf</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

    <span class="c1">-------------  test process ------------------------------------------------</span>
    <span class="k">process</span>
        <span class="k">variable</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">next_addr</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">variable</span> <span class="n">err_flag</span> <span class="o">:</span> <span class="kt">boolean</span> <span class="o">:=</span> <span class="n">false</span><span class="p">;</span>
    <span class="k">begin</span>

        <span class="c1">----------------------------------------------------------------------------------------</span>
        <span class="c1">--                          TEST SEQUENCE STARTS HERE </span>
        <span class="c1">----------------------------------------------------------------------------------------</span>
        <span class="n">read_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span> <span class="n">write_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>

        <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
        <span class="n">curr_addr</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
        
        <span class="k">while</span> <span class="n">true</span> <span class="k">loop</span>

            <span class="c1">-- write followed by read</span>
            <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span><span class="n">data_in</span><span class="p">,</span><span class="n">write_en</span><span class="p">,</span><span class="n">curr_addr</span><span class="p">,</span><span class="n">curr_addr</span><span class="p">);</span>
            <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span><span class="n">read_en</span><span class="p">,</span><span class="n">curr_addr</span><span class="p">);</span>

            <span class="c1">-- check data_out</span>
            <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_df</span> <span class="o">=</span> <span class="n">curr_addr</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with decoder fault&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
            <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_saf</span> <span class="o">=</span> <span class="n">curr_addr</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with stuck-at-fault&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
            <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">curr_addr</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with pattern-sensitive-fault&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
            <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">curr_addr</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling-fault&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>


            <span class="n">err_flag</span> <span class="o">:=</span> <span class="n">err_flag</span> <span class="k">or</span> <span class="p">(</span><span class="n">data_out_df</span> <span class="o">/=</span> <span class="n">curr_addr</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">data_out_saf</span> <span class="o">/=</span> <span class="n">curr_addr</span><span class="p">)</span> <span class="k">or</span>
                    <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">curr_addr</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">curr_addr</span><span class="p">);</span>

            <span class="n">next_addr</span> <span class="o">:=</span> <span class="n">Increment</span><span class="p">(</span><span class="n">addr</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">next_addr</span> <span class="o">=</span> <span class="n">zero8</span><span class="p">)</span> <span class="k">then</span>
                <span class="k">exit</span><span class="p">;</span>
            <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
            <span class="n">curr_addr</span> <span class="o">:=</span> <span class="n">next_addr</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>


        <span class="c1">----------------------------------------------------------------------------------------</span>
        <span class="c1">--                               TEST SEQUENCE ENDS HERE</span>
        <span class="c1">----------------------------------------------------------------------------------------</span>

        <span class="k">assert</span> <span class="k">not</span> <span class="n">err_flag</span> <span class="n">report</span> <span class="s">&quot;Test Failed&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
        <span class="k">assert</span> <span class="n">err_flag</span> <span class="n">report</span> <span class="s">&quot;Test Passed&quot;</span> <span class="k">severity</span> <span class="n">NOTE</span><span class="p">;</span>
        <span class="k">wait</span><span class="p">;</span>

    <span class="k">end</span> <span class="k">process</span><span class="p">;</span>
    
<span class="k">end</span> <span class="nc">Behave</span><span class="p">;</span>
</code></pre></div>


<p><strong>If you run the simulation using the algorithm in this existing test bench, the memory block seems to be functioning correctly. However, each of the memory blocks has faults present in it (as you can verify by examining the VHDL code). Why did the test fail to detect the errors? Now one needs to modify the test-bench to use a single test (sequence of reads and writes) that can detect any decoder/stuck-at/coupling/pattern-sensitive fault in MemBlock. Pattern-sensitive faults may be assumed to be for a neighbourhood which consists of adjacent bits in the same column of the 256x8 array. Conﬁrm that this modiﬁed test-bench detects that each of the MemBlock instances is faulty. </strong></p>

<p>This was given as an assignment in <em>Verification and Testing of VLSI</em> course offered by <strong>Prof M. P. Desai</strong> at IIT Bombay.</p>

<p>Attached is the detailed solution to this problem. We attach the VHDL code which is my solution. However, in my solution, I make an assumption that only adjacent cells can cause coupling/pattern sensitive/decoder faults. In practice, situation is much worse than that. We have used <strong>ghdl</strong> compiler to test it.</p>

<div class="highlight"><pre><code class="vhdl"><span class="k">use</span> <span class="nn">std.textio.all</span><span class="p">;</span>

<span class="k">entity</span> <span class="nc">MemTest</span> <span class="k">is</span>
<span class="k">end</span> <span class="k">entity</span> <span class="nc">MemTest</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">Behave</span> <span class="k">of</span> <span class="nc">MemTest</span> <span class="k">is</span>

    <span class="c1">-- utility function: to increment an address</span>
    <span class="k">function</span> <span class="n">Increment</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">)</span> <span class="k">return</span> <span class="kt">bit_vector</span> <span class="k">is</span>
        <span class="k">alias</span> <span class="n">lx</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">to</span> <span class="n">x</span><span class="na">&#39;length</span><span class="p">)</span> <span class="k">is</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">variable</span> <span class="n">ret_var</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">to</span> <span class="n">x</span><span class="na">&#39;length</span><span class="p">);</span>
        <span class="k">variable</span> <span class="n">carry</span><span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>
    <span class="k">begin</span>
        <span class="n">carry</span> <span class="o">:=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">I</span> <span class="k">in</span> <span class="n">x</span><span class="na">&#39;length</span> <span class="k">downto</span> <span class="mi">1</span> <span class="k">loop</span>
            <span class="n">ret_var</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">:=</span> <span class="n">lx</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="k">xor</span> <span class="n">carry</span><span class="p">;</span>
            <span class="n">carry</span> <span class="o">:=</span> <span class="n">carry</span> <span class="k">and</span> <span class="n">lx</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
        <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ret_var</span><span class="p">);</span>
    <span class="k">end</span> <span class="nc">Increment</span><span class="p">;</span>

    <span class="k">signal</span> <span class="n">addr</span><span class="p">,</span> <span class="n">addr2</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">data_out_df</span><span class="p">,</span> <span class="n">data_out_saf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">,</span><span class="n">data_out_cf</span> <span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>    
    <span class="k">signal</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">write_en</span><span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>
 
    <span class="k">component</span> <span class="nc">MemBlock</span> 
        <span class="k">generic</span><span class="p">(</span><span class="n">has_decoder_fault</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span><span class="p">,</span> <span class="n">has_psf</span><span class="p">,</span> <span class="n">has_cf</span><span class="o">:</span> <span class="kt">boolean</span> <span class="o">:=</span> <span class="n">false</span><span class="p">);</span>
        <span class="k">port</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
            <span class="n">read_en</span><span class="p">,</span> <span class="n">write_en</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit</span><span class="p">;</span>
            <span class="n">data_out</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">));</span>
    <span class="k">end</span> <span class="k">component</span><span class="p">;</span>

    <span class="k">constant</span> <span class="n">zero8</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>



    <span class="c1">-- utility procedures</span>

    <span class="c1">-- Write addr/data pair into memory using write_en</span>
    <span class="k">procedure</span> <span class="n">Write</span><span class="p">(</span><span class="k">signal</span> <span class="n">addr</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">signal</span> <span class="n">data</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">signal</span> <span class="n">write_en</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">;</span>
        <span class="n">addr_var</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">data_var</span><span class="o">:</span> <span class="k">in</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">))</span> <span class="k">is</span>
        <span class="k">begin</span>
            <span class="n">addr</span> <span class="o">&lt;=</span> <span class="n">addr_var</span><span class="p">;</span>
            <span class="n">data</span> <span class="o">&lt;=</span> <span class="n">data_var</span><span class="p">;</span>

            <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>  
            <span class="n">write_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>

            <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
            <span class="n">write_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>

            <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
        <span class="k">end</span> <span class="k">procedure</span><span class="p">;</span>

        <span class="c1">-- Read data from memory using read_en, addr.</span>
        <span class="c1">-- NOTE: data must be present on data_out signal on</span>
        <span class="c1">--       completion of procedure.</span>
        <span class="k">procedure</span> <span class="n">Read</span><span class="p">(</span><span class="k">signal</span> <span class="n">addr</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">signal</span> <span class="n">read_en</span><span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">;</span> <span class="n">addr_var</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">))</span> <span class="k">is</span>
            <span class="k">begin</span>
                <span class="n">addr</span> <span class="o">&lt;=</span> <span class="n">addr_var</span><span class="p">;</span>
                <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
                <span class="n">read_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
                <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
                <span class="n">read_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
            <span class="k">end</span> <span class="k">procedure</span><span class="p">;</span>


        <span class="k">begin</span>


            <span class="c1">-- four memory blocks, each of which has one type of fault in it.</span>


            <span class="c1">-- this has a decoder-fault</span>
            <span class="n">mb_df</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> 
                <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_df</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

            <span class="c1">-- this has stuck-at-faults in the array</span>
            <span class="n">mb_saf</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">,</span> 
                <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_saf</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

            <span class="c1">-- this has a pattern-sensitive-fault in the array.  The neighbourhood for the</span>
            <span class="c1">-- fault is adjacent bits in the same column of the array.</span>
            <span class="n">mb_psf</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> 
                <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_psf</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

            <span class="c1">-- this has some coupling faults in the array</span>
            <span class="n">mb_cf</span><span class="o">:</span> <span class="n">MemBlock</span> <span class="k">generic</span> <span class="k">map</span><span class="p">(</span><span class="n">has_decoder_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_stuck_at_fault</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> 
                <span class="n">has_psf</span> <span class="o">=&gt;</span> <span class="n">false</span><span class="p">,</span> <span class="n">has_cf</span> <span class="o">=&gt;</span> <span class="n">true</span><span class="p">)</span>
            <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">addr</span> <span class="o">=&gt;</span> <span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span> <span class="o">=&gt;</span> <span class="n">data_in</span><span class="p">,</span> 
                <span class="n">data_out</span> <span class="o">=&gt;</span> <span class="n">data_out_cf</span><span class="p">,</span> <span class="n">read_en</span> <span class="o">=&gt;</span> <span class="n">read_en</span><span class="p">,</span>
                <span class="n">write_en</span> <span class="o">=&gt;</span> <span class="n">write_en</span><span class="p">);</span>

            <span class="c1">-------------  test process ------------------------------------------------</span>
            <span class="k">process</span>
            <span class="k">variable</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">next_addr</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">,</span> <span class="n">next_data</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">variable</span> <span class="n">err_flag</span> <span class="o">:</span> <span class="kt">boolean</span> <span class="o">:=</span> <span class="n">false</span><span class="p">;</span>
            <span class="k">variable</span> <span class="n">err_add</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">,</span> <span class="n">l_df</span><span class="p">,</span> <span class="n">l_saf</span><span class="p">,</span> <span class="n">l_cf</span> <span class="o">:</span> <span class="n">line</span><span class="p">;</span>
        <span class="k">begin</span>

            <span class="c1">-----------------------------------------------------------</span>
            <span class="c1">--        TEST SEQUENCE STARTS HERE </span>
            <span class="c1">-----------------------------------------------------------</span>
            <span class="n">read_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span> <span class="n">write_en</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>

            <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
            <span class="n">curr_addr</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>

            <span class="k">while</span> <span class="n">true</span> <span class="k">loop</span>

                <span class="c1">-----------------------------------------------------</span>
                <span class="c1">--  This test will test the stuck at 1/0 faults.</span>
                <span class="c1">-----------------------------------------------------    </span>

                <span class="n">temp_data</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>  
                <span class="n">next_data</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;1&#39;</span><span class="p">);</span>

                <span class="c1">-- test for s-a-1 faults.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">);</span>

                <span class="c1">-- assert yourself.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_saf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with stuck-at-1-fault&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_saf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span> 
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; D: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; saf1: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="n">data_out_saf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_saf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">);</span>

                <span class="c1">-- assert yourself.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_saf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with stuck-at-0-fault&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_saf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span> 
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; D: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; saf0: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_saf</span><span class="p">,</span> <span class="n">data_out_saf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_saf</span><span class="p">);</span>
                <span class="c1">-- NOTE : Must reset this cell while doing cf testing. Else</span>
                <span class="c1">--    problem might occur in first and last cells. </span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
               <span class="c1">--            while true loop</span>
                <span class="n">temp_data</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
                <span class="n">next_data</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;1&#39;</span><span class="p">);</span>

                <span class="n">temp_n_addr</span> <span class="o">:=</span> <span class="n">Increment</span><span class="p">(</span><span class="n">curr_addr</span><span class="p">);</span>
                <span class="c1">-- reset the cell we are going to test.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>

                <span class="c1">-- give an up-transition at left location and read data. If there isa</span>
                <span class="c1">-- coupling faults. This should change the value of cell from 0 to 1</span>

                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span> <span class="c1">-- read the next address. </span>

                <span class="c1">-- Assert yourserf if you got it right.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling l_at_0_u faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span> 

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 0lu &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- give a low transition at left location and read data. If there is a</span>
                <span class="c1">-- coupling fault then this should change the value of cell from 0 to 1 </span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span> 
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span> <span class="c1">-- read the next address.</span>

                <span class="c1">-- Assert yourserf if you got it right.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling l_at_0_d faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span> 

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span> 
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 0ld &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>


                <span class="c1">-- REPEAT IT FROM RIGHT SIDE</span>
                <span class="n">temp_nn_addr</span> <span class="o">:=</span> <span class="n">Increment</span><span class="p">(</span><span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="c1">-- give an up-transition at right location and read data. If there isa</span>
                <span class="c1">-- coupling faults. This should change the value of cell from 0 to 1</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span> <span class="c1">-- read the next address. </span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling r_at_0_u faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span> 
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span> 
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 0ru &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- give a low transition at right location and read data. If there is a</span>
                <span class="c1">-- coupling fault then this should change the value of cell from 0 to 1 </span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span> 
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span> <span class="c1">-- read the next address. </span>
                <span class="c1">-- Assert yourserf if you are right.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling r_at_0_d faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>   
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span> 
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 0rd &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span> 

                <span class="n">temp_data</span> <span class="o">:=</span> <span class="s">&quot;00000000&quot;</span><span class="p">;</span>
                <span class="n">next_data</span> <span class="o">:=</span> <span class="s">&quot;11111111&quot;</span><span class="p">;</span>
                <span class="n">temp_n_addr</span> <span class="o">:=</span> <span class="n">Increment</span><span class="p">(</span><span class="n">curr_addr</span><span class="p">);</span>
                <span class="n">temp_nn_addr</span> <span class="o">:=</span> <span class="n">Increment</span><span class="p">(</span><span class="n">temp_n_addr</span><span class="p">);</span>

                <span class="c1">-- Following line will write 1 in next adress.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>

                <span class="c1">-- Give an up transition at left location and read for fault.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="c1">-- assert it.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling l_at_1_u faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 1lu &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- Give a down transition at left location. And read for faults.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span> 

                <span class="c1">-- Assert yourserf if you are right.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling l_at_1_d faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 1lu &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- Give an up transition at right location.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span> 

                <span class="c1">-- Assert yourserf if you are right.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling r_at_1_u faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 1ru &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- Give a down transition at right location.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span> 

                <span class="c1">-- Assert yourserf if you are right.</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_cf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data mismatch in memory with coupling r_at_1_d faults&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>

                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_cf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A: &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; 1rd &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_cf</span><span class="p">,</span> <span class="n">data_out_cf</span><span class="p">);</span>
                    <span class="c1">-- reset the memory cell.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">----------------------------------------------</span>
                <span class="c1">-- Test pattern for Pattern Sensitive Faults. </span>
                <span class="c1">----------------------------------------------</span>
                <span class="n">temp_data</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
                <span class="n">next_data</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;1&#39;</span><span class="p">);</span>

                <span class="n">temp_n_addr</span> <span class="o">:=</span> <span class="n">Increment</span><span class="p">(</span><span class="n">curr_addr</span><span class="p">);</span>
                <span class="n">temp_nn_addr</span> <span class="o">:=</span> <span class="n">Increment</span><span class="p">(</span><span class="n">temp_n_addr</span><span class="p">);</span>

                <span class="c1">-- reset the cell we are going to test.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>

                <span class="c1">------- case 1 </span>
                <span class="c1">-- Write 1 in left and 0 in right and check for PSF.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="c1">-- Now write 1 in the cell and read the same value.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l1r0 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l1r0 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- write 0 in the cell and check for the PSF. </span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l1r0 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l1r0 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-------- case 2</span>
                <span class="c1">-- Write 1 in left and 1 in right and check for PSF</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="c1">-- Now write 1 in the cell and read the same value.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l1r1 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l1r1 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- write 0 in the cell and check for the PSF. </span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l1r1 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l1r1 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
                <span class="c1">-------- case 3</span>
                <span class="c1">-- Write 0 in left and 1 in right and check for PSF</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="c1">-- Now write 1 in the cell and read the same value.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l0r1 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l1r1 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- write 0 in the cell and check for the PSF. </span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l0r1 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l0r1 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-------- case 4</span>
                <span class="c1">-- Write 0 in left and 0 in right and check for PSF</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="c1">-- Now write 1 in the cell and read the same value.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l0r0 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l0r0 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-- write 0 in the cell and check for the PSF. </span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_psf</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Data can not be written due to l0r0 PSF.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>
                <span class="c1">-- log this error.</span>
                <span class="k">if</span> <span class="n">data_out_psf</span> <span class="o">/=</span> <span class="n">temp_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;A &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; l0r0 &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_psf</span><span class="p">,</span> <span class="n">data_out_psf</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_psf</span><span class="p">);</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="c1">-------------------------------------</span>
                <span class="c1">-- Decoder fault.</span>
                <span class="c1">------------------------------------</span>
                <span class="c1">-- NOTE : Ideally one should write 0 to a cell and write 1 to</span>
                <span class="c1">-- all the cells which are 1 hamming distance away to cover all</span>
                <span class="c1">-- the stuck-at-fautls in decoder. Here, we check immediate left</span>
                <span class="c1">-- and right cell for fautls.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">next_data</span><span class="p">);</span>
                <span class="c1">-- write all 1 in left and right cell.</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                <span class="n">Read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">read_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                <span class="k">assert</span> <span class="p">(</span><span class="n">data_out_df</span> <span class="o">=</span> <span class="n">next_data</span><span class="p">)</span> <span class="n">report</span>
                <span class="s">&quot;Decoder fault - value written into some adjacent cell.&quot;</span> <span class="k">severity</span> <span class="n">ERROR</span><span class="p">;</span>

                <span class="c1">-- log this error</span>
                <span class="k">if</span> <span class="n">data_out_df</span> <span class="o">/=</span> <span class="n">next_data</span> <span class="k">then</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_df</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;To &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_df</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_df</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; From &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_df</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">);</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_df</span><span class="p">,</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot; DF &quot;</span><span class="p">));</span>
                    <span class="n">write</span><span class="p">(</span><span class="n">l_df</span><span class="p">,</span> <span class="n">data_out_df</span><span class="p">);</span>
                    <span class="n">writeline</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l_df</span><span class="p">);</span>
                <span class="c1">-- reset cells for next test.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_n_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">temp_nn_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>
                    <span class="c1">-- to make sure this does not interfere with other test.</span>
                    <span class="n">Write</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data_in</span><span class="p">,</span> <span class="n">write_en</span><span class="p">,</span> <span class="n">curr_addr</span><span class="p">,</span> <span class="n">temp_data</span><span class="p">);</span>

                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>

                <span class="n">next_addr</span> <span class="o">:=</span> <span class="n">temp_n_addr</span><span class="p">;</span>
                <span class="c1">-- if all addresses have been reached, exit</span>
                <span class="k">if</span><span class="p">(</span><span class="n">next_addr</span> <span class="o">=</span> <span class="s">&quot;11111111&quot;</span><span class="p">)</span> <span class="k">then</span>
                    <span class="k">exit</span><span class="p">;</span>
                <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
                <span class="n">curr_addr</span> <span class="o">:=</span> <span class="n">next_addr</span><span class="p">;</span> 

            <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>

            <span class="k">assert</span> <span class="n">false</span> <span class="n">report</span> <span class="s">&quot;Test completed.&quot;</span> <span class="k">severity</span> <span class="n">NOTE</span><span class="p">;</span>
            <span class="k">wait</span><span class="p">;</span>

        <span class="k">end</span> <span class="k">process</span><span class="p">;</span>

    <span class="k">end</span> <span class="nc">Behave</span><span class="p">;</span>
</code></pre></div>


<h2>Solution</h2>

<p>Use following commands to run the test.</p>

<div class="highlight"><pre><code class="vhdl"><span class="n">ghdl</span> <span class="o">-</span><span class="n">i</span> <span class="o">*</span><span class="p">.</span><span class="n">vhd</span>
<span class="n">ghdl</span> <span class="o">-</span><span class="n">m</span> <span class="n">memtest</span>
<span class="n">ghdl</span> <span class="o">-</span><span class="n">r</span> <span class="n">memtest</span> <span class="c1">--stop-time=40ms --vcd=dilawar.vcd</span>
</code></pre></div>




</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li> <a href="/numerical%20computation/2014/01/30/Coding-With-Floats/">Coding with float</a></li>
    
      <li> <a href="/noguinomousenoproblem/2014/01/29/Using-mutt/">Using mutt, saving password and writing mail in markdown</a></li>
    
      <li> <a href="/[%22tutorial%22,%20%22literate%20programming%22]/2013/10/30/Python-frontend-for-noweb/">Python front-end for Noweb literate tool</a></li>
    
  </ul>
</div>

<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

<!-- Google analytic -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47774588-1', 'dilawar.github.io');
    ga('send', 'pageview');
</script>

<div id="comment">
  
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'dilawarblog'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>



    </section>

    <!-- Latex in post -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Google analytic -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-47774588-1', 'dilawar.github.io');
        ga('send', 'pageview');
    </script>
</body>
</html>
