<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="None worth writing.">
    <title>Simulation of PN junction at equilibrium in Scilab</title>
    <meta name="author" content="Dilawar Singh" />
    <link rel="stylesheet" href="https://github.com/themes/minimal/stylesheets/styles.css">
 <style>
      header { zoom: 1.0; width: 150px}
      header h1 { margin-bottom: 5px; }
      header h1 a { color: #494949; font-weight: bold; }
      header h3 { margin-top: 20px; margin-bottom: 5px; }
      header p.view { margin-bottom: 5px; }
      header p.view small { padding-top: 2px; }
      header ul {
        zoom: 0.7;
        margin-top: 25px;
      }
      section { width: 600px }
      section p { margin-top: 10px; }
      section h1 { margin-bottom: 15px; }
      section h2 { margin-bottom: 10px; }
      section h2 { margin-bottom: 10px; }
      footer { bottom: 20px; }
      footer p { margin-bottom: 5px; }
      .half-width {
        float: left;
        width: 100px;
        list-style: none;
        padding: 5px;
        margin: 7px;
        margin-bottom: 10px;
      }
      .half-width h4 {
        margin-bottom: 5px;
      }
      .half-width ul {
        padding-left: 0;
      }
      .half-width ul li {
        list-style: inside;
        font-size: 15px;
      }
      .clear-fix {
        clear: both;
      }
    </style>
    <script src="https://github.com/themes/minimal/javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
</head>

<body>
    <div class="wrapper">
        <header>
        <h1><a href="/">Notes</a></h1>
        <p class="view"> <img src= "http://dilawar.github.io/images/pic_enhanced.jpg"
            alt="dilawar" height="150" width="150" /> </p>
        <p class="view"><a href="/projects/index.html">Open Source Projects <small>Might be useful to you</small></a></p>
        <p class="view"><a target="_blank"
            href="http://www.cen.iitb.ac.in/">Masters<small>Microelectronics and
                VLSI</small></a> 
        </p>
        <p class="view"><a target="_blank"
            href="http://www.ee.iitb.ac.in/~hpc">Ph. D.</a><small>Abandoned
            after 3 years</small>
        </p>
        <p class="view"><a target="_blank"
            href="http://www.ncbs.res.in/bhalla">Research Fellow <small>Moose,
                The Neural Simulator</small> </a> 
        </p>
        <p class="view"><a target="_blank"
            href="http://dilawarrajput.wordpress.com">Blog <small>This much I
                know</small></a> 
        </p>

        
        </header>

        <footer>
        </footer>

    <section id="post">
    <h1>Simulation of PN junction at equilibrium in Scilab </h1>
<div class="content">
  <p><strong>This is version 0.5 There is a bug in this implementation, since hole
concentration is constant in both side of the junction. Thanks to Urmimala for
pointing this out.. In ver 1.0, we'll provide complete documentation and will
remove this bug.  </strong></p>

<p>The <a href="http://ecee.colorado.edu/~bart/book/book/chapter4/ch4_2.htm">pn-junction</a>
is quite an interesting junction. If most the semiconductor theory can be tested
around it, it also poses significant challenges in numerical method also. In
this  implementation in Scilab, we are solving Poisson equation to get the
results when junction is in equilibrium. No part of this work used propriety
softwares. Please wait for complete documentation of code.</p>

<h1>Simulation Results</h1>

<p>[gallery link="file" columns="5" orderby="rand"]</p>

<p>Click on image to enlarge it.</p>

<h1>Scilab Functions</h1>

<p>This is my top most function. Write a script which call this function and every other functions will be called in order.</p>

<div class="highlight"><pre><code class="matlab"><span class="o">//</span> <span class="n">This</span> <span class="k">function</span> <span class="n">will</span> <span class="n">discretized</span> <span class="n">the</span> <span class="n">domain</span> <span class="n">and</span> <span class="n">will</span> <span class="n">create</span> <span class="n">a</span> <span class="n">grid</span> <span class="n">points</span><span class="p">.</span>
<span class="o">//</span> <span class="n">Then</span> <span class="n">we</span><span class="o">&#39;</span><span class="n">ll</span> <span class="n">discretise</span> <span class="n">the</span> <span class="n">equation</span> <span class="n">there</span><span class="p">.</span> <span class="n">Matrices</span>
<span class="o">//</span> <span class="n">will</span> <span class="n">be</span> <span class="n">created</span> <span class="n">and</span> <span class="n">saved</span> <span class="n">in</span> <span class="n">an</span> <span class="n">binary</span> <span class="n">file</span> <span class="k">for</span> <span class="n">further</span> <span class="n">processing</span><span class="p">.</span>

<span class="k">function</span><span class="w"> </span>[] <span class="p">=</span><span class="w"> </span><span class="nf">solveEquilibriumCondition</span><span class="p">()</span><span class="w"></span>
<span class="w">  </span><span class="o">//</span> <span class="n">Open</span> <span class="n">file</span> <span class="n">to</span> <span class="n">read</span> <span class="n">the</span> <span class="n">data</span><span class="p">.</span>
  <span class="o">//</span> <span class="n">Check</span> <span class="k">if</span> <span class="n">file</span> <span class="n">exists</span><span class="p">.</span> <span class="n">If</span> <span class="n">not</span> <span class="n">run</span> <span class="n">the</span> <span class="n">script</span> <span class="n">to</span> <span class="n">create</span> <span class="n">it</span><span class="p">.</span>
  <span class="n">ifExists</span> <span class="p">=</span> <span class="n">exists</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">profilePN</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="k">if</span> <span class="n">ifExists</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">then</span>
  <span class="nb">disp</span><span class="p">(</span>&quot;<span class="n">File</span> <span class="n">does</span> <span class="n">not</span> <span class="n">exist</span><span class="p">.</span> <span class="n">Executing</span> <span class="n">script</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">this</span> <span class="n">file</span><span class="p">.</span>&quot;<span class="p">);</span>
  <span class="n">exec</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">profilePN</span><span class="p">.</span><span class="n">sci</span>&quot;<span class="p">);</span>
  <span class="n">profilePN</span><span class="p">();</span>
  <span class="n">load</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">profilePN</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="n">load</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">myParameters</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="k">else</span>
  <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;File already exists. Loading ...&#39;</span><span class="p">);</span>
  <span class="n">load</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">profilePN</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="n">load</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">myParameters</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="nb">disp</span><span class="p">(</span>&quot;<span class="k">if</span> <span class="n">there</span> <span class="n">is</span> <span class="n">any</span> <span class="n">problem</span> <span class="n">with</span> <span class="n">this</span> <span class="n">file</span><span class="p">.</span> <span class="n">Delete</span> <span class="n">it</span> <span class="n">and</span> <span class="n">re</span><span class="o">-</span><span class="n">execute</span> <span class="n">this</span> <span class="k">function</span><span class="o">/</span><span class="n">script</span><span class="p">.</span>&quot;<span class="p">);</span>
  <span class="k">end</span><span class="p">;</span>

  <span class="n">delta_acc</span> <span class="p">=</span> <span class="mf">1E-5</span><span class="p">;</span>               <span class="o">//</span> <span class="n">Preset</span> <span class="n">the</span> <span class="n">Tolerance</span>

  <span class="o">////////////////////////////////////////////////////////////////////////</span>
  <span class="o">///////////</span> <span class="n">EQUILIBRIUM</span>  <span class="n">SOLUTION</span> <span class="n">PART</span> <span class="n">BEGINS</span>                      <span class="o">/////</span>
  <span class="o">////////////////////////////////////////////////////////////////////////</span>

  <span class="o">//</span> <span class="n">Define</span> <span class="n">the</span> <span class="n">elements</span> <span class="n">of</span> <span class="n">the</span> <span class="n">coefficient</span> <span class="n">matrix</span> <span class="k">for</span> <span class="n">the</span> <span class="n">internal</span> <span class="n">nodes</span> <span class="n">and</span>
  <span class="n">dx2</span> <span class="p">=</span> <span class="n">delX</span><span class="o">*</span><span class="n">delX</span><span class="p">;</span>
  <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">2</span><span class="p">:</span> <span class="n">n_max</span><span class="o">-</span><span class="mi">1</span>
  <span class="n">a</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx2</span><span class="p">;</span>
  <span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx2</span><span class="p">;</span>
  <span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">dx2</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">))</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">)));</span>
  <span class="n">f</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">))</span> <span class="o">-</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">))</span> <span class="o">-</span> <span class="n">dop</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">exp</span><span class="p">(</span><span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">))</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">)));</span>
  <span class="k">end</span>

  <span class="o">//</span> <span class="n">Define</span> <span class="n">the</span> <span class="n">elements</span> <span class="n">of</span> <span class="n">the</span> <span class="n">coefficient</span> <span class="n">matrix</span> <span class="n">and</span> <span class="n">initialize</span> <span class="n">the</span> <span class="n">forcing</span>
  <span class="o">//</span>   <span class="k">function</span> <span class="n">at</span> <span class="n">the</span> <span class="n">ohmic</span> <span class="n">contacts</span>

  <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">fi</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">a</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">c</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">b</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">f</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span> <span class="p">=</span> <span class="n">fi</span><span class="p">(</span><span class="n">n_max</span><span class="p">);</span>

  <span class="o">//</span>  <span class="n">Start</span> <span class="n">the</span> <span class="n">iterative</span> <span class="n">procedure</span> <span class="k">for</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">of</span> <span class="n">the</span> <span class="n">linearized</span> <span class="n">Poisson</span>
  <span class="o">//</span>  <span class="n">equation</span> <span class="n">using</span> <span class="n">LU</span> <span class="n">decomposition</span> <span class="n">method</span><span class="p">:</span>

  <span class="n">flag_conv</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>                   <span class="o">//</span> <span class="n">convergence</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Poisson</span> <span class="n">loop</span>
  <span class="n">k_iter</span><span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="n">flag_conv</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">then</span>
  <span class="n">k_iter</span> <span class="p">=</span> <span class="n">k_iter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">alpha1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">for</span> <span class="nb">i</span><span class="p">=</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">n_max</span>
  <span class="n">beta1</span><span class="p">(</span><span class="nb">i</span><span class="p">)=</span><span class="n">a</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">/</span><span class="n">alpha1</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">alpha1</span><span class="p">(</span><span class="nb">i</span><span class="p">)=</span><span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">-</span><span class="n">beta1</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">end</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Solution</span> <span class="n">of</span> <span class="n">Lv</span> <span class="p">=</span> <span class="n">f</span>
  <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">2</span><span class="p">:</span><span class="n">n_max</span>
  <span class="n">v</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">f</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">beta1</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">end</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Solution</span> <span class="n">of</span> <span class="n">U</span><span class="o">*</span><span class="n">fi</span> <span class="p">=</span> <span class="n">v</span>

  <span class="n">temp</span> <span class="p">=</span> <span class="n">v</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span><span class="o">/</span><span class="n">alpha1</span><span class="p">(</span><span class="n">n_max</span><span class="p">);</span>
  <span class="n">delta</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span> <span class="p">=</span> <span class="n">temp</span> <span class="o">-</span> <span class="n">fi</span><span class="p">(</span><span class="n">n_max</span><span class="p">);</span>
  <span class="n">fi</span><span class="p">(</span><span class="n">n_max</span><span class="p">)=</span><span class="n">temp</span><span class="p">;</span>
  <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="p">(</span><span class="n">n_max</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span>       <span class="o">//</span><span class="n">delta</span>
                     <span class="n">temp</span> <span class="p">=</span> <span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">alpha1</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
                     <span class="n">delta</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">temp</span> <span class="o">-</span> <span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
                     <span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">temp</span><span class="p">;</span>
                     <span class="k">end</span><span class="p">;</span>

                     <span class="n">delta_max</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>

                     <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">n_max</span>
                     <span class="n">xx</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span>
                     <span class="k">if</span> <span class="n">xx</span> <span class="o">&gt;</span> <span class="n">delta_max</span> <span class="n">then</span>
                     <span class="n">delta_max</span><span class="p">=</span><span class="n">xx</span><span class="p">;</span>
                     <span class="k">end</span><span class="p">;</span>
                     <span class="o">//</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;delta_max = %d&#39;</span><span class="p">,</span><span class="n">delta_max</span><span class="p">)</span>      <span class="o">//</span><span class="s">&#39;k_iter = %d&#39;</span><span class="p">,</span><span class="n">k_iter</span><span class="p">,</span><span class="s">&#39;</span>
<span class="s">                     end;</span>

<span class="s">                     //delta_max=max(abs(delta));</span>

<span class="s">                     // Test convergence and recalculate forcing function and</span>
<span class="s">                     // central coefficient b if necessary</span>
<span class="s">                     if delta_max &lt; delta_acc then</span>
<span class="s">                     flag_conv = 1;</span>
<span class="s">                     else</span>
<span class="s">                     for i = 2: n_max-1</span>
<span class="s">                     b(i) = -(2/dx2 + exp(fi(i)) + exp(-fi(i)));</span>
<span class="s">                     f(i) = exp(fi(i)) - exp(-fi(i)) - dop(i) - fi(i)*(exp(fi(i)) + exp(-fi(i)));</span>
<span class="s">                     end;</span>
<span class="s">                     end;</span>
<span class="s">                     end;</span>
<span class="s">                     xx1(1) = delX*1e4;</span>
<span class="s">                     for i = 2:n_max-1</span>
<span class="s">                     Ec(i) = dEc - Vt*fi(i);     //Values from the second Node%</span>
<span class="s">                     ro(i) = -ni*(exp(fi(i)) - exp(-fi(i)) - dop(i));</span>
<span class="s">                     el_field1(i) = -(fi(i+1) - fi(i))*Vt/(delX*Ldi);</span>
<span class="s">                     el_field2(i) = -(fi(i+1) - fi(i-1))*Vt/(2*delX*Ldi);</span>
<span class="s">                     n(i) = exp(fi(i));</span>
<span class="s">                     p(i) = exp(-fi(i));</span>
<span class="s">                     xx1(i) = xx1(i-1) + delX*Ldi*1e4;</span>
<span class="s">                     end;</span>

<span class="s">                     Ec(1) = Ec(2);</span>
<span class="s">                     Ec(n_max) = Ec(n_max-1);</span>
<span class="s">                     xx1(n_max) = xx1(n_max-1) + delX*Ldi*1e4;</span>
<span class="s">                     el_field1(1) = el_field1(2);</span>
<span class="s">                     el_field2(1) = el_field2(2);</span>
<span class="s">                     el_field1(n_max) = el_field1(n_max-1);</span>
<span class="s">                     el_field2(n_max) = el_field2(n_max-1);</span>
<span class="s">                     nf = n*ni;</span>
<span class="s">                     pf = p*ni;</span>
<span class="s">                     ro(1) = ro(2);</span>
<span class="s">                     ro(n_max) = ro(n_max-1);</span>

<span class="s">                     // save all these values in a file.</span>
<span class="s">                     save(&#39;</span><span class="n">equilibriumSol</span><span class="p">.</span><span class="n">dat</span><span class="o">&#39;</span><span class="p">,</span> <span class="n">Ec</span><span class="p">,</span> <span class="n">Vt</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">xx1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">pf</span><span class="p">,</span> <span class="n">ro</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">el_field1</span><span class="p">,</span> <span class="n">el_field2</span><span class="p">);</span>
<span class="n">h</span> <span class="p">=</span> <span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">xx1</span><span class="p">,</span> <span class="n">Vt</span><span class="o">*</span><span class="n">fi</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x [um]&#39;</span><span class="p">);</span>
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Potential [eV]&#39;</span><span class="p">);</span>
  <span class="n">title</span><span class="p">(</span><span class="s">&#39;Potential vs Position - at Equilibrium&#39;</span><span class="p">);</span>
  <span class="n">xs2gif</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;./figs/PotentialVsPos.gif&#39;</span><span class="p">);</span>
  <span class="n">close</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>

<span class="n">h</span> <span class="p">=</span> <span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">xx1</span><span class="p">,</span> <span class="p">[</span><span class="n">el_field1</span><span class="p">,</span> <span class="n">el_field2</span><span class="p">],</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="o">//</span><span class="n">plot</span><span class="p">(</span><span class="n">xx1</span><span class="p">,</span> <span class="n">el_field2</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x [um]&#39;</span><span class="p">);</span>
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Electric Field [V/cm]&#39;</span><span class="p">);</span>
  <span class="n">title</span><span class="p">(</span><span class="s">&#39;Field Profile vs Position - at Equilibrium&#39;</span><span class="p">);</span>
  <span class="n">xs2gif</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;./figs/ElectricalFieldVsPos.gif&#39;</span><span class="p">);</span>
  <span class="n">close</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>

<span class="n">h</span> <span class="p">=</span> <span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">plot2d1</span><span class="p">(</span>&quot;<span class="n">onn</span>&quot;<span class="p">,</span> <span class="n">xx1</span><span class="p">,</span> <span class="p">[</span><span class="n">nf</span><span class="p">,</span> <span class="n">pf</span><span class="p">]);</span>
  <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x [um]&#39;</span><span class="p">);</span>
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Electron &amp; Hole Densities [1/cm^3]&#39;</span><span class="p">);</span>
  <span class="n">title</span><span class="p">(</span><span class="s">&#39;Electron &amp; Hole Densities vs Position - at Equilibrium&#39;</span><span class="p">);</span>
  <span class="n">legend</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="s">&#39;p&#39;</span><span class="p">);</span>
  <span class="n">xs2gif</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;./figs/ElectronAndHolesDensity.gif&#39;</span><span class="p">);</span>
  <span class="n">close</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>

<span class="n">h</span> <span class="p">=</span> <span class="n">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">xx1</span><span class="p">,</span> <span class="n">q_e</span><span class="o">*</span><span class="n">ro</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x [um]&#39;</span><span class="p">);</span>
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Total Charge Density [C/cm^3]&#39;</span><span class="p">);</span>
  <span class="n">title</span><span class="p">(</span><span class="s">&#39;Total Charge Density vs Position - at Equilibrium&#39;</span><span class="p">);</span>
  <span class="n">xs2gif</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">&#39;./figs/TotalChargeDensity.gif&#39;</span><span class="p">);</span>
  <span class="n">close</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>

<span class="n">h</span> <span class="p">=</span> <span class="n">figure</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">xx1</span><span class="p">,</span> <span class="n">Ec</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x [um]&#39;</span><span class="p">);</span>
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Conduction Band Energy (eV)&#39;</span><span class="p">);</span>
  <span class="n">title</span><span class="p">(</span><span class="s">&#39;Conduction Band vs Position - at Equilibrium&#39;</span><span class="p">);</span>
  <span class="n">xs2gif</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">&#39;./figs/ConductionBandDiagram.gif&#39;</span><span class="p">);</span>
  <span class="n">close</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>

  <span class="n">endfunction</span>
</code></pre></div>


<p>  This function will profile the PN junction and return the doping and p and n distributions across the junction</p>

<div class="highlight"><pre><code class="matlab">  <span class="o">//</span> <span class="n">This</span> <span class="k">function</span> <span class="n">will</span> <span class="n">profile</span> <span class="n">the</span> <span class="n">PN</span> <span class="n">junction</span> <span class="n">and</span> <span class="k">return</span> <span class="n">the</span> <span class="n">doping</span> <span class="n">and</span> <span class="n">p</span> <span class="n">and</span> <span class="n">n</span>
  <span class="o">//</span> <span class="n">distributions</span> <span class="n">across</span> <span class="n">the</span> <span class="n">junction</span><span class="p">.</span>
  <span class="o">//</span> <span class="n">Open</span> <span class="n">file</span> <span class="n">to</span> <span class="n">read</span> <span class="n">the</span> <span class="n">data</span><span class="p">.</span>
  <span class="o">//</span> <span class="n">Check</span> <span class="k">if</span> <span class="n">file</span> <span class="n">exists</span><span class="p">.</span> <span class="n">If</span> <span class="n">not</span> <span class="n">run</span> <span class="n">the</span> <span class="n">script</span> <span class="n">to</span> <span class="n">create</span> <span class="n">it</span><span class="p">.</span>
<span class="k">function</span><span class="w"> </span>[] <span class="p">=</span><span class="w"> </span><span class="nf">profilePN</span><span class="p">()</span><span class="w"></span>

<span class="w">  </span><span class="n">ifExists</span> <span class="p">=</span> <span class="n">exists</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">myParameters</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="k">if</span> <span class="n">ifExists</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">then</span>
  <span class="nb">disp</span><span class="p">(</span>&quot;<span class="n">File</span> <span class="n">does</span> <span class="n">not</span> <span class="n">exist</span><span class="p">.</span> <span class="n">Executing</span> <span class="n">script</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">this</span> <span class="n">file</span><span class="p">.</span>&quot;<span class="p">);</span>
  <span class="n">exec</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">calcParameters</span><span class="p">.</span><span class="n">sci</span>&quot;<span class="p">);</span>
  <span class="n">calcParameters</span><span class="p">();</span>
  <span class="n">load</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">myParameters</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="k">else</span>
  <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;File already exists. Loading ...&#39;</span><span class="p">);</span>
  <span class="n">load</span><span class="p">(</span>&quot;<span class="o">./</span><span class="n">myParameters</span><span class="p">.</span><span class="n">dat</span>&quot;<span class="p">);</span>
  <span class="nb">disp</span><span class="p">(</span>&quot;<span class="k">if</span> <span class="n">there</span> <span class="n">is</span> <span class="n">any</span> <span class="n">problem</span> <span class="n">with</span> <span class="n">this</span> <span class="n">file</span><span class="p">.</span> <span class="n">Delete</span> <span class="n">it</span> <span class="n">and</span> <span class="n">re</span><span class="o">-</span><span class="n">execute</span> <span class="n">this</span> <span class="k">function</span><span class="o">/</span><span class="n">script</span><span class="p">.</span>&quot;<span class="p">);</span>
  <span class="k">end</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Now</span> <span class="n">we</span> <span class="n">need</span> <span class="n">to</span> <span class="n">discretise</span> <span class="n">the</span> <span class="n">boundries</span><span class="p">.</span>
  <span class="o">//</span> <span class="n">Set</span> <span class="n">grid</span> <span class="nb">size</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">extrinsic</span> <span class="n">Debye</span> <span class="n">Lengths</span><span class="p">.</span>
  <span class="k">if</span> <span class="n">Ldn</span> <span class="o">&lt;</span> <span class="n">Ldp</span> <span class="n">then</span>
  <span class="n">delX</span> <span class="p">=</span> <span class="n">Ldn</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
  <span class="k">else</span>
  <span class="n">delX</span> <span class="p">=</span> <span class="n">Ldp</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
  <span class="k">end</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Length</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pn</span> <span class="n">junction</span><span class="p">.</span>
  <span class="k">if</span> <span class="n">Wp</span> <span class="o">&gt;</span> <span class="n">Wn</span> <span class="n">then</span>
  <span class="n">length_pn</span> <span class="p">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">Wn</span><span class="p">;</span>
  <span class="k">else</span>
  <span class="n">length_pn</span> <span class="p">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">Wp</span><span class="p">;</span>
  <span class="k">end</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">We</span> <span class="n">have</span> <span class="n">grid</span> <span class="nb">size</span><span class="p">,</span> <span class="n">We</span> <span class="n">have</span> <span class="nb">length</span><span class="p">.</span> <span class="n">Calculate</span> <span class="n">the</span> <span class="n">total</span> <span class="n">points</span><span class="p">.</span>
  <span class="n">n_max</span> <span class="p">=</span> <span class="nb">floor</span><span class="p">(</span><span class="n">length_pn</span><span class="o">/</span><span class="n">delX</span><span class="p">);</span>

  <span class="n">delX</span> <span class="p">=</span> <span class="n">delX</span><span class="o">/</span><span class="n">Ldi</span><span class="p">;</span> <span class="o">//</span> <span class="n">renormalize</span> <span class="n">lengths</span> <span class="n">with</span> <span class="n">Ldi</span><span class="p">.</span>

  <span class="o">//</span> <span class="n">Set</span> <span class="n">up</span> <span class="n">doping</span> <span class="n">C</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">=</span> <span class="n">Nd</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">Na</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">that</span> <span class="n">is</span> <span class="n">normalised</span> <span class="n">with</span> <span class="n">ni</span>
  <span class="o">//</span> <span class="n">Half</span> <span class="n">of</span> <span class="n">the</span> <span class="n">point</span> <span class="n">are</span> <span class="n">p</span> <span class="n">type</span><span class="p">,</span> <span class="n">rests</span> <span class="n">are</span> <span class="n">n</span><span class="o">-</span><span class="n">types</span><span class="p">.</span>
  <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n_max</span>
  <span class="k">if</span> <span class="nb">i</span> <span class="o">&lt;</span><span class="p">=</span> <span class="n">n_max</span><span class="o">/</span><span class="mi">2</span> <span class="n">then</span>
  <span class="n">dop</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="n">Na</span><span class="o">/</span><span class="n">ni</span><span class="p">;</span> <span class="o">//</span> <span class="n">p</span> <span class="n">type</span>
  <span class="k">elseif</span> <span class="nb">i</span> <span class="o">&gt;</span> <span class="n">n_max</span><span class="o">/</span><span class="mi">2</span> <span class="n">then</span>
  <span class="n">dop</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">Nd</span><span class="o">/</span><span class="n">ni</span><span class="p">;</span> <span class="o">//</span> <span class="n">n</span> <span class="n">type</span>
  <span class="k">end</span>
  <span class="k">end</span>
  <span class="o">//</span> <span class="n">Initialize</span> <span class="n">the</span> <span class="n">potential</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">requirement</span> <span class="n">of</span> <span class="n">charge</span> <span class="n">neutrality</span>
  <span class="o">//</span> <span class="n">throughout</span> <span class="n">the</span> <span class="n">whole</span> <span class="n">structure</span><span class="p">.</span>
  <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">n_max</span>
  <span class="n">tempZ</span> <span class="p">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dop</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
  <span class="k">if</span> <span class="n">tempZ</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">then</span>
  <span class="n">tempX</span> <span class="p">=</span> <span class="n">tempZ</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">tempZ</span><span class="o">*</span><span class="n">tempZ</span><span class="p">)));</span>
  <span class="k">elseif</span> <span class="n">tempZ</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="n">then</span>
  <span class="n">tempX</span> <span class="p">=</span> <span class="n">tempZ</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">sqrt</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">tempZ</span><span class="o">*</span><span class="n">tempZ</span><span class="p">)));</span>
  <span class="k">end</span><span class="p">;</span>
  <span class="n">fi</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">tempX</span><span class="p">);</span>
  <span class="n">n</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">tempX</span><span class="p">;</span>
  <span class="n">p</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">tempX</span><span class="p">;</span>
  <span class="k">end</span><span class="p">;</span>
  <span class="n">save</span><span class="p">(</span><span class="s">&#39;profilePN.dat&#39;</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dop</span><span class="p">,</span> <span class="n">length_pn</span><span class="p">,</span> <span class="n">n_max</span><span class="p">,</span> <span class="n">delX</span><span class="p">);</span>
  <span class="n">endfunction</span>
</code></pre></div>


<p>  Here is the part which calculates the parameters to be used by above posted functions. [sourcecode language="matlab"]</p>

<div class="highlight"><pre><code class="matlab">  <span class="o">//</span> <span class="n">This</span> <span class="k">function</span> <span class="n">will</span> <span class="n">calculate</span> <span class="n">the</span> <span class="n">parameters</span><span class="p">.</span> <span class="n">We</span><span class="o">&#39;</span><span class="n">ll</span> <span class="n">store</span> <span class="n">these</span> <span class="n">parameters</span>
  <span class="o">//</span> <span class="n">in</span> <span class="n">a</span> <span class="n">file</span><span class="p">.</span> <span class="n">We</span><span class="o">&#39;</span><span class="n">ll</span> <span class="n">use</span> <span class="n">this</span> <span class="n">file</span> <span class="n">to</span> <span class="n">reuse</span> <span class="n">the</span> <span class="n">parametes</span> <span class="k">for</span> <span class="n">further</span> <span class="n">processing</span><span class="p">.</span>
  <span class="o">//</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="n">Dilawar</span><span class="p">,</span> <span class="mi">2010</span>
  <span class="o">//</span> <span class="n">dilawar</span><span class="p">@</span><span class="n">ee</span><span class="p">.</span><span class="n">iitb</span><span class="p">.</span><span class="n">ac</span><span class="p">.</span><span class="n">in</span>
  <span class="o">//</span> <span class="n">www</span><span class="p">.</span><span class="n">ee</span><span class="p">.</span><span class="n">iitb</span><span class="p">.</span><span class="n">ac</span><span class="p">.</span><span class="n">in</span><span class="o">/</span><span class="n">student</span><span class="o">/~</span><span class="n">dilawar</span>
  <span class="o">//</span> <span class="n">GNU</span> <span class="o">-</span> <span class="n">GPL</span>

  <span class="o">//</span> <span class="n">This</span> <span class="k">function</span> <span class="n">should</span> <span class="k">return</span> <span class="n">a</span> <span class="n">ascii</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">parameters</span> <span class="n">which</span> <span class="n">are</span> <span class="n">to</span>
  <span class="o">//</span> <span class="n">be</span> <span class="n">used</span> <span class="n">later</span><span class="p">.</span>
<span class="k">function</span><span class="w"> </span>[] <span class="p">=</span><span class="w"> </span><span class="nf">calcParameters</span><span class="p">()</span><span class="w"></span>

<span class="w">  </span><span class="n">T</span> <span class="p">=</span> <span class="mi">300</span><span class="p">;</span>           <span class="o">//</span> <span class="n">Substrate</span> <span class="n">is</span> <span class="n">Silicon</span><span class="p">.</span> <span class="n">Temp</span> <span class="mi">300</span> <span class="n">K</span>
  <span class="n">u_e</span> <span class="p">=</span> <span class="mi">1350</span><span class="p">;</span>        <span class="o">//</span> <span class="n">cm</span><span class="o">*</span><span class="n">cm</span><span class="o">/</span><span class="n">V</span><span class="o">/</span><span class="n">s</span> <span class="n">Mobility</span> <span class="n">of</span> <span class="n">electron</span> <span class="n">in</span> <span class="n">Silicon</span>
  <span class="n">u_p</span> <span class="p">=</span> <span class="mi">480</span><span class="p">;</span>         <span class="o">//</span> <span class="n">cm</span><span class="o">*</span><span class="n">cm</span><span class="o">/</span><span class="n">V</span><span class="o">/</span><span class="n">s</span>  <span class="n">Mobility</span> <span class="n">of</span> <span class="n">holes</span> <span class="n">in</span> <span class="n">Silicon</span>
  <span class="n">D_n</span> <span class="p">=</span> <span class="mi">35</span><span class="p">;</span>          <span class="o">//</span> <span class="n">cm</span><span class="o">*</span><span class="n">cm</span><span class="o">/</span><span class="n">s</span>   <span class="n">Diffusion</span> <span class="n">coeff</span><span class="p">.</span>
  <span class="n">D_p</span> <span class="p">=</span> <span class="mf">12.4</span><span class="p">;</span>        <span class="o">//</span> <span class="n">cm</span><span class="o">*</span><span class="n">cm</span><span class="o">/</span><span class="n">s</span>  <span class="n">Diffusion</span> <span class="n">coeff</span><span class="p">.</span>
  <span class="n">q_e</span> <span class="p">=</span> <span class="mf">1.6e-19</span><span class="p">;</span>     <span class="o">//</span> <span class="n">Charge</span> <span class="n">on</span> <span class="n">an</span> <span class="n">electron</span><span class="p">.</span>
  <span class="n">kt_q</span> <span class="p">=</span> <span class="mf">0.0259</span><span class="p">;</span>
  <span class="n">kb</span> <span class="p">=</span> <span class="mf">1.38e-23</span><span class="p">;</span>     <span class="o">//</span> <span class="n">Boltzmann</span> <span class="n">Constant</span> <span class="n">JK</span>^<span class="o">-</span><span class="mi">1</span>
  <span class="nb">eps</span> <span class="p">=</span> <span class="mf">1.05e-12</span><span class="p">;</span>    <span class="o">//</span> <span class="n">Permittivity</span> <span class="n">of</span> <span class="n">undopes</span> <span class="n">silicon</span><span class="p">.</span>
  <span class="n">ni</span> <span class="p">=</span> <span class="mf">1.5e10</span><span class="p">;</span>       <span class="o">//</span> <span class="n">Intrinsic</span> <span class="n">carrier</span> <span class="n">concentration</span>
  <span class="n">Vt</span> <span class="p">=</span> <span class="n">kb</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">q_e</span><span class="p">;</span>     <span class="o">//</span> <span class="n">Threshold</span> <span class="n">voltages</span><span class="p">.</span>
  <span class="n">RNc</span> <span class="p">=</span> <span class="mf">2.8e20</span><span class="p">;</span>
  <span class="n">dEc</span> <span class="p">=</span> <span class="n">Vt</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">RNc</span><span class="o">/</span><span class="n">ni</span><span class="p">);</span>
  <span class="n">tauN0</span> <span class="p">=</span> <span class="mf">0.1e-6</span><span class="p">;</span>
  <span class="n">tauP0</span> <span class="p">=</span> <span class="mf">0.1e-6</span><span class="p">;</span>
  <span class="n">mu_n0</span> <span class="p">=</span> <span class="mi">1500</span><span class="p">;</span>
  <span class="n">mu_p0</span> <span class="p">=</span> <span class="mi">1000</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Define</span> <span class="n">doping</span> <span class="n">values</span><span class="p">.</span>
  <span class="n">Na</span> <span class="p">=</span> <span class="mf">1e16</span><span class="p">;</span>
  <span class="n">Nd</span> <span class="p">=</span> <span class="mf">1e18</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Calculate</span> <span class="n">parameters</span><span class="p">.</span>
  <span class="n">Vbi</span> <span class="p">=</span> <span class="n">Vt</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">Na</span><span class="o">*</span><span class="n">Nd</span><span class="o">/</span><span class="p">(</span><span class="n">ni</span><span class="o">*</span><span class="n">ni</span><span class="p">));</span>                <span class="o">//</span> <span class="n">Built</span><span class="o">-</span><span class="n">in</span> <span class="n">voltage</span><span class="p">.</span>
  <span class="n">W</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">eps</span><span class="o">*</span><span class="p">(</span><span class="n">Na</span> <span class="o">+</span> <span class="n">Nd</span><span class="p">)</span><span class="o">*</span><span class="n">Vbi</span><span class="o">/</span><span class="p">(</span><span class="n">q_e</span><span class="o">*</span><span class="n">Na</span><span class="o">*</span><span class="n">Nd</span><span class="p">)</span> <span class="p">);</span> <span class="o">//</span> <span class="n">Depletion</span> <span class="n">width</span>
  <span class="n">Wn</span> <span class="p">=</span> <span class="n">W</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">Na</span><span class="o">/</span><span class="p">(</span><span class="n">Na</span> <span class="o">+</span> <span class="n">Nd</span><span class="p">));</span>                  <span class="o">//</span> <span class="n">Depletion</span> <span class="n">width</span> <span class="n">at</span> <span class="n">n</span> <span class="n">side</span><span class="p">.</span>
  <span class="n">Wp</span> <span class="p">=</span> <span class="n">W</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">Nd</span><span class="o">/</span><span class="p">(</span><span class="n">Na</span> <span class="o">+</span> <span class="n">Nd</span><span class="p">));</span>                  <span class="o">//</span> <span class="n">Depletion</span> <span class="n">width</span> <span class="n">at</span> <span class="n">p</span> <span class="n">side</span>
  <span class="n">Wone</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">eps</span><span class="o">*</span><span class="n">Vbi</span><span class="o">/</span><span class="p">(</span><span class="n">q_e</span><span class="o">*</span><span class="n">Na</span><span class="p">));</span>            <span class="o">//</span>
  <span class="n">E_p</span> <span class="p">=</span> <span class="n">q_e</span><span class="o">*</span><span class="n">Nd</span><span class="o">*</span><span class="n">Wn</span><span class="o">/</span><span class="nb">eps</span><span class="p">;</span>
  <span class="n">Ldn</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">eps</span><span class="o">*</span><span class="n">Vt</span><span class="o">/</span><span class="p">(</span><span class="n">q_e</span><span class="o">*</span><span class="n">Nd</span><span class="p">));</span>
  <span class="n">Ldp</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">eps</span><span class="o">*</span><span class="n">Vt</span><span class="o">/</span><span class="p">(</span><span class="n">q_e</span><span class="o">*</span><span class="n">Na</span><span class="p">));</span>
  <span class="n">Ldi</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">eps</span><span class="o">*</span><span class="n">Vt</span><span class="o">/</span><span class="p">(</span><span class="n">q_e</span><span class="o">*</span><span class="n">ni</span><span class="p">));</span>

  <span class="o">//</span> <span class="n">We</span><span class="o">&#39;</span><span class="n">d</span> <span class="n">like</span> <span class="n">to</span> <span class="n">save</span> <span class="n">our</span> <span class="n">paramters</span> <span class="n">in</span> <span class="n">some</span> <span class="n">file</span><span class="p">.</span>
  <span class="n">save</span><span class="p">(</span><span class="s">&#39;myParameters.dat&#39;</span><span class="p">,</span> <span class="n">q_e</span><span class="p">,</span> <span class="n">Na</span><span class="p">,</span> <span class="n">Nd</span><span class="p">,</span> <span class="n">Vbi</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">Wp</span><span class="p">,</span> <span class="n">E_p</span><span class="p">,</span> <span class="n">Ldn</span><span class="p">,</span> <span class="n">Ldp</span><span class="p">,</span> <span class="n">Ldi</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">dEc</span><span class="p">,</span> <span class="n">Vt</span><span class="p">,</span> <span class="n">kt_q</span><span class="p">,</span> <span class="n">mu_n0</span><span class="p">,</span> <span class="n">mu_p0</span><span class="p">);</span>
  <span class="n">endfunction</span><span class="p">;</span>
</code></pre></div>


<p>  <div style="position:absolute;left:-10000px;top:3197px;width:1px;height:1px;overflow:hidden;" id="_mcePaste" class="mcePaste">// This function will discretize the domain and will create a grid points.  // Then we'll discretise the equation there. Matrices  // will be created and saved in an binary file for further processing.    function [] = solveEquilibriumCondition()  // Open file to read the data.  // Check if file exists. If not run the script to create it.  ifExists = exists("./profilePN.dat");  if ifExists == 0 then  disp("File does not exist. Executing script to generate this file.");  exec("./profilePN.sci");  profilePN();  load("./profilePN.dat");  load("./myParameters.dat");  else  disp('File already exists. Loading ...');  load("./profilePN.dat");  load("./myParameters.dat");  disp("if there is any problem with this file. Delete it and re-execute this function/script.");  end;  delta_acc = 1E-5;               // Preset the Tolerance  ////////////////////////////////////////////////////////////////////////  /////////// EQUILIBRIUM  SOLUTION PART BEGINS                      /////  ////////////////////////////////////////////////////////////////////////  // Define the elements of the coefficient matrix for the internal nodes and  dx2 = delX<em>delX;  for i = 2: n_max-1  a(i) = 1/dx2;  c(i) = 1/dx2;  b(i) = -(2/dx2+exp(fi(i))+exp(-fi(i)));  f(i) = exp(fi(i)) - exp(-fi(i)) - dop(i) - fi(i)</em>(exp(fi(i))+exp(-fi(i)));  end  // Define the elements of the coefficient matrix and initialize the forcing  //   function at the ohmic contacts  a(1) = 0;  c(1) = 0;  b(1) = 1;  f(1) = fi(1);  a(n_max) = 0;  c(n_max) = 0;  b(n_max) = 1;  f(n_max) = fi(n_max);  //  Start the iterative procedure for the solution of the linearized Poisson  //  equation using LU decomposition method:  flag_conv = 0;                   // convergence of the Poisson loop  k_iter= 0;  while flag_conv == 0 then  k_iter = k_iter + 1;  alpha1(1) = b(1);  for i= 2 : n_max  beta1(i)=a(i)/alpha1(i-1);  alpha1(i)=b(i)-beta1(i)<em>c(i-1);  end;  // Solution of Lv = f  v(1) = f(1);  for i = 2:n_max  v(i) = f(i) - beta1(i)</em>v(i-1);  end;  // Solution of U<em>fi = v  temp = v(n_max)/alpha1(n_max);  delta(n_max) = temp - fi(n_max);  fi(n_max)=temp;  for i = (n_max-1):-1:1       //delta  temp = (v(i)-c(i)</em>fi(i+1))/alpha1(i);  delta(i) = temp - fi(i);  fi(i) = temp;  end;  delta_max = 0;  for i = 1: n_max  xx = abs(delta(i));  if xx > delta_max then  delta_max=xx;  end;  //sprintf('delta_max = %d',delta_max)      //'k_iter = %d',k_iter,'  end;  //delta_max=max(abs(delta));  // Test convergence and recalculate forcing function and  // central coefficient b if necessary  if delta_max &lt; delta_acc then  flag_conv = 1;  else  for i = 2: n_max-1  b(i) = -(2/dx2 + exp(fi(i)) + exp(-fi(i)));  f(i) = exp(fi(i)) - exp(-fi(i)) - dop(i) - fi(i)<em>(exp(fi(i)) + exp(-fi(i)));  end;  end;  end;  xx1(1) = delX</em>1e4;  for i = 2:n_max-1  Ec(i) = dEc - Vt<em>fi(i);     //Values from the second Node%  ro(i) = -ni</em>(exp(fi(i)) - exp(-fi(i)) - dop(i));  el_field1(i) = -(fi(i+1) - fi(i))<em>Vt/(delX</em>Ldi);  el_field2(i) = -(fi(i+1) - fi(i-1))<em>Vt/(2</em>delX<em>Ldi);  n(i) = exp(fi(i));  p(i) = exp(-fi(i));  xx1(i) = xx1(i-1) + delX</em>Ldi<em>1e4;  end;  Ec(1) = Ec(2);  Ec(n_max) = Ec(n_max-1);  xx1(n_max) = xx1(n_max-1) + delX</em>Ldi<em>1e4;  el_field1(1) = el_field1(2);  el_field2(1) = el_field2(2);  el_field1(n_max) = el_field1(n_max-1);  el_field2(n_max) = el_field2(n_max-1);  nf = n</em>ni;  pf = p<em>ni;  ro(1) = ro(2);  ro(n_max) = ro(n_max-1);  // save all these values in a file.  save('equilibriumSol.dat', Ec, Vt, fi, xx1, nf, pf, ro, n, p, el_field1, el_field2);  h = figure(1)  plot(xx1, Vt</em>fi,'r','LineWidth',2)  xlabel('x [um]');  ylabel('Potential [eV]');  title('Potential vs Position - at Equilibrium');  xs2gif(1, './figs/PotentialVsPos.gif');  close(h);  h = figure(2)  plot(xx1, [el_field1, el_field2],'r','LineWidth',2)  //plot(xx1, el_field2,'r','LineWidth',2)  xlabel('x [um]');  ylabel('Electric Field [V/cm]');  title('Field Profile vs Position - at Equilibrium');  xs2gif(2, './figs/ElectricalFieldVsPos.gif');  close(h);  h = figure(3)  plot2d1("onn", xx1, [nf, pf]);  xlabel('x [um]');  ylabel('Electron &amp; Hole Densities [1/cm<sup>3]');</sup>  title('Electron &amp; Hole Densities vs Position - at Equilibrium');  legend('n','p');  xs2gif(3, './figs/ElectronAndHolesDensity.gif');  close(h);  h = figure(4)  plot(xx1, q_e*ro,'r','LineWidth',2)  xlabel('x [um]');  ylabel('Total Charge Density [C/cm<sup>3]');</sup>  title('Total Charge Density vs Position - at Equilibrium');  xs2gif(4, './figs/TotalChargeDensity.gif');  close(h);  h = figure(5)  plot(xx1, Ec,'r','LineWidth',2)  xlabel('x [um]');  ylabel('Conduction Band Energy (eV)');  title('Conduction Band vs Position - at Equilibrium');  xs2gif(5, './figs/ConductionBandDiagram.gif');  close(h);  endfunction</div></p>

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li> <a href="/numerical%20computation/2014/01/30/Coding-With-Floats/">Coding with float</a></li>
    
      <li> <a href="/noguinomousenoproblem/2014/01/29/Using-mutt/">Using mutt, saving password and writing mail in markdown</a></li>
    
      <li> <a href="/[%22tutorial%22,%20%22literate%20programming%22]/2013/10/30/Python-frontend-for-noweb/">Python front-end for Noweb literate tool</a></li>
    
  </ul>
</div>

<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

<!-- Google analytic -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47774588-1', 'dilawar.github.io');
    ga('send', 'pageview');
</script>

<div id="comment">
  
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'dilawarblog'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>



    </section>

    <!-- Latex in post -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Google analytic -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-47774588-1', 'dilawar.github.io');
        ga('send', 'pageview');
    </script>
</body>
</html>
